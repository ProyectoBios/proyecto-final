<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
    <title>Estado de Rack</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--[if lte IE 8]><script th:src="@{assets/js/ie/html5shiv.js}"></script><![endif]-->
    <link rel="stylesheet" th:href="@{assets/css/main.css}" />
    <!--[if lte IE 8]><link rel="stylesheet" th:href="@{assets/css/ie8.css}" /><![endif]-->
    <!--[if lte IE 9]><link rel="stylesheet" th:href="@{assets/css/ie9.css}" /><![endif]-->

    <style>
            .grilla tbody tr:nth-child(2n + 1) {
                background-color: rgba(144, 144, 144, 0.075);
            }
            .bordes tbody tr td {
                border: 1px solid;
            }
    </style>
    </head>
    <body>

        <!-- Header -->
        <header id="header">
            <h1 id="logo"><a th:href="@{/}">Centenario</a></h1>
            <nav id="nav">
                <ul>
                    <li><a th:href="@{/}">Inicio</a></li>
                    <li>
                        <a href="#" class="submenu">Menú</a>
                        <ul>
                            <li><a th:href="@{/ABMProducto}">Mantenimiento de Productos</a></li>
                            <li><a th:href="@{/AltaRack}">Alta Rack</a></li>
                            <li><a th:href="@{/EstadoDeRack}">Estado de Rack</a></li>
                            <li><a th:href="@{/AltaLote}">Alta Lote</a></li>
                            <li><a th:href="@{/BajaLoteXVencimiento}">Baja de Lote por Vencimiento</a></li>
                            <li><a th:href="@{/AltaOrdenDePedido}">Alta orden de pedido</a></li>
                            <li><a th:href="@{/EstadoDePedido}">Estado de pedidos</a></li>
                            <li><a th:href="@{/MoverLote}">Mover Lote</a></li>
                            <li>
                                <a href="#">Submenu</a>
                                <ul>
                                    <li><a href="#">Opción uno</a></li>
                                    <li><a href="#">Opción dos</a></li>
                                    <li><a href="#">Opción tres</a></li>
                                    <li><a href="#">Opción cuatro</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><a href="#">Salir</a></li>
                </ul>
            </nav>
        </header>

        <!-- Main -->
        <section id="main" class="wrapper">
                    <div class="inner">
                        <header >
                            <h2>Sección Usuarios</h2>
                        </header>

                        <!-- Content -->
                        <div class="content">
                            <h3>Estado de Racks</h3>
                            <!-- Formulario con la Tabla -->
                            <form action="#" th:action="@{/EstadoDeRack}" name="EstadoDeRack" method="post">
                                <table>
                                    <tbody>
                                    <tr>
                                        <td style="width: 25%"><label>Seleccione un rack: </label></td>
                                        <td>
                                            <select name="letraRacks">
                                                <option th:value="null">Rack</option>
                                                <option th:each="r : ${session.racks}" th:value="${r.letra}" th:text="${r.letra}"></option>
                                            </select>
                                        </td>
                                        <td style="width: 60%">
                                            <input type="submit" name="action" value="Seleccionar" />
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>

                                <table th:if="${tablaRack}" class="bordes" id="rack" style="display: table; text-align: center">
                                    <tbody>
                                    <tr th:each="fila, iter1 : ${session.lotes}">
                                        <th:block th:each="l, iter2 : ${fila}"> <!--Renderizar la salida como link clickeable y pasar el lote a la func. de JavaScript -->
                                            <td th:if="${l.cantUnidades != 0}" th:onclick="|VerDatosLote(${iter1.index}, ${iter2.index})|" th:text="${l.id + ' ' + l.ubicacion.ubicacionString}" style="background-color: aqua; cursor: pointer;">ID Lote</td>
                                            <td th:if="${l.cantUnidades == 0}" th:text="${'vacío ' + l.ubicacion.ubicacionString}">vacío</td>
                                        </th:block>
                                   </tr>
                                   </tbody>
                               </table>

                               <table id="espLote" style="display: none">
                                   <thead>
                                       <th style="width: 15%">Ubicación</th>
                                       <th># ID</th>
                                       <th style="width: 40%">Producto</th>
                                       <th style="width: 10%">Cantidad</th>
                                       <th>Vence</th>
                                   </thead>
                                   <tbody> <!-- Rellear mediante JavaScript las celdas con las propiedades del lote de la Session -->
                                  <tr id="datosLote">
                                       <td></td>
                                       <td></td>
                                       <td></td>
                                       <td></td>
                                       <td></td>
                                   </tr>
                                   </tbody>

                               </table>

                               <label th:text="${mensaje}">Mensaje</label>

                           </form>

                       </div>

                   </div>
               </section>

       <!-- Footer -->
        <footer id="footer">

                <p class="copyright">&copy; Dieguin y Alvarin corporation. All rights reserved.<br />
                    <a href="#">Terms of Use</a> | <a href="#">Privacy Policy</a> | <a href="#">Contact</a></p>
            </footer>

        <script th:inline="javascript">
            function VerDatosLote(i,j) {
                /*<![CDATA[*/
                var lotes = [[${session.lotes}]];
                var lote = lotes[i][j];

                var tabla = document.getElementById("espLote");
                tabla.style.display = "table";
                tabla.deleteRow(1);

                var fila = tabla.insertRow(1);

                var x = fila.insertCell(0);
                x.innerHTML = lote.ubicacion.ubicacionString;

                x = fila.insertCell(1);
                x.innerHTML = lote.id;

                x = fila.insertCell(2);
                x.innerHTML = lote.producto.nombre;

                x = fila.insertCell(3);
                x.innerHTML = lote.cantUnidades;

                x = fila.insertCell(4);
                var fechaVenc = new Date(lote.fechaVencimiento);
                x.innerHTML = fechaVenc.getDate() + "/" + fechaVenc.getMonth() + "/" + fechaVenc.getFullYear();

                /*]]>*/
            }
        </script>

    <!-- Scripts -->
    <script th:src="@{assets/js/jquery.min.js}"> </script>
    <script th:src="@{assets/js/jquery.dropotron.min.js}"> </script>
    <script th:src="@{assets/js/jquery.scrollex.min.js}"></script>
    <script th:src="@{assets/js/skel.min.js}"></script>
    <script th:src="@{assets/js/util.js}"></script>
    <!--[if lte IE 8]><script th:src="@{assets/js/ie/respond.min.js}"></script><![endif]-->
    <script th:src="@{assets/js/main.js}"></script>

    </body>
</html>